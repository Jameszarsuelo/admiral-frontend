import{d as C,u as E,r as y,t as j,j as e,S as f,L as s,I as l,B as x}from"./index-Bd_g5yr_.js";import{z as o,u as B,a as P,h as v,F as q,C as t,b as i}from"./external-QyOfrcf0.js";import{P as T}from"./PageBreadCrumb-CllaJxAj.js";import{C as w}from"./ComponentCard-CuEWkNls.js";import{S as g,P as M,a as A}from"./Switch-BirVSo3m.js";import{U as I,a as L,S as b}from"./UserFormSchema-X7zWze6p.js";import{a as k,u as D}from"./supplier_api-B1YJQngG.js";import"./index-YGHbPIAQ.js";import"./utils-HNMyEq71.js";import"./index-BT1M0go5.js";o.object({id:o.number().optional(),vat_number:o.string().nonempty("VAT number is required"),invoice_query_email:o.string().email("Invalid email address").nonempty("Invoice query email is required"),phone:o.string().optional(),max_payment_days:o.number().min(0,"Max payment days cannot be negative").optional(),target_payment_days:o.number().min(0,"Target payment days cannot be negative").optional(),preferred_payment_day:o.string().optional(),priority:o.number().min(1,"Priority must be at least 1").optional(),user:L});const U=I.omit({created_by:!0,updated_by:!0,deleted_by:!0,created_at:!0,updated_at:!0,deleted_at:!0}).extend({vat_number:o.string().nonempty("VAT number is required"),invoice_query_email:o.string().email("Invalid email address").nonempty("Invoice query email is required"),phone:o.string().optional(),max_payment_days:o.number().min(0,"Max payment days cannot be negative").optional(),target_payment_days:o.number().min(0,"Target payment days cannot be negative").optional(),preferred_payment_day:o.string().optional(),priority:o.number().min(1,"Priority must be at least 1").optional()}),V=[{code:"UK",label:"+44"},{code:"PH",label:"+63"}],z=[{value:0,label:"SMS"},{value:1,label:"Email"}],O=[{value:"mr",label:"Mr."},{value:"ms",label:"Ms."},{value:"mrs",label:"Mrs."},{value:"dr",label:"Dr."}];function $(){const{id:m}=C(),u=E(),[h,_]=y.useState(!1),{handleSubmit:N,control:n,setError:c,reset:p}=B({defaultValues:{salutation:"",firstname:"",lastname:"",email:"",phone:"",mobile:"+44",two_fa_enabled:!1,two_fa_type:0,user_type_id:0,user_profile_id:0,address_line_1:"",address_line_2:"",address_line_3:"",city:"",county:"",country:"",postcode:"",vat_number:"",invoice_query_email:"",max_payment_days:30,priority:5,target_payment_days:7,preferred_payment_day:""},resolver:P(U)});y.useEffect(()=>{m&&(_(!0),k(m).then(a=>{const r=a.user;p({id:a.id,salutation:r.user_info.salutation,firstname:r.firstname,lastname:r.lastname,email:r.email,two_fa_enabled:!!r.two_fa_enabled,two_fa_type:r.two_fa_type,user_type_id:r.user_type_id,user_profile_id:r.user_profile_id,phone:r.user_info.phone??"",mobile:r.user_info.mobile,address_line_1:r.user_info.address_line_1||"",address_line_2:r.user_info.address_line_2||"",address_line_3:r.user_info.address_line_3||"",city:r.user_info.city,county:r.user_info.county,country:r.user_info.country,postcode:r.user_info.postcode,vat_number:a.vat_number,invoice_query_email:a.invoice_query_email,max_payment_days:a.max_payment_days,target_payment_days:a.target_payment_days,preferred_payment_day:a.preferred_payment_day||"",priority:a.priority})}).catch(a=>(j.error("Failed to load Supplier data"),v(a,c))).finally(()=>{_(!1)}))},[m,p,c]);function F(a){j.promise(D(a),{loading:m?"Updating Supplier...":"Creating Supplier...",success:()=>(setTimeout(()=>{u("/suppliers")},2e3),m?"Supplier updated successfully!":"Supplier created successfully!"),error:r=>v(r,c)}),console.log("Submitted data:",a)}return e.jsxs(e.Fragment,{children:[e.jsx(T,{pageTitle:"Supplier"}),e.jsxs(w,{title:m?"Edit Supplier":"Add Supplier",children:[h?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(f,{size:"lg"})}):e.jsx("form",{id:"form-supplier",onSubmit:N(F),children:e.jsx(q,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-6 ",children:[e.jsx("div",{children:e.jsx(t,{name:"salutation",control:n,render:({field:a,fieldState:r})=>e.jsxs(i,{"data-invalid":r.invalid,children:[e.jsx(s,{htmlFor:"salutation",children:"Salutation"}),e.jsx(g,{value:a.value,options:O,placeholder:"Select Salutation",onChange:d=>a.onChange(d),onBlur:a.onBlur,className:"dark:bg-dark-900"}),r.error&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.error.message})]})})}),e.jsx("div",{children:e.jsx(t,{name:"firstname",control:n,render:({field:a,fieldState:r})=>e.jsxs(i,{"data-invalid":r.invalid,children:[e.jsx(s,{htmlFor:"input",children:"First Name"}),e.jsx(l,{...a,type:"text",id:"input",name:"firstname",placeholder:"Enter first name"}),r.error&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.error.message})]})})}),e.jsx("div",{children:e.jsx(t,{name:"lastname",control:n,render:({field:a,fieldState:r})=>e.jsxs(i,{"data-invalid":r.invalid,children:[e.jsx(s,{htmlFor:"lastname",children:"Last Name"}),e.jsx(l,{...a,type:"text",id:"lastname",name:"lastname",placeholder:"Enter last name"}),r.error&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.error.message})]})})}),e.jsx("div",{children:e.jsx(t,{name:"email",control:n,render:({field:a,fieldState:r})=>e.jsxs(i,{"data-invalid":r.invalid,children:[e.jsx(s,{htmlFor:"input",children:"Email"}),e.jsx(l,{...a,type:"text",id:"input",name:"email",placeholder:"e.g. john@test.com"}),r.error&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.error.message})]})})}),e.jsx("div",{children:e.jsx(t,{name:"mobile",control:n,render:({field:a,fieldState:r})=>e.jsxs(i,{"data-invalid":r.invalid,children:[e.jsx(s,{htmlFor:"input",children:"Mobile"}),e.jsx(M,{value:a.value,countries:V,selectPosition:"start",placeholder:"+1 (555) 000-0000",onChange:d=>{a.onChange(d)},onBlur:a.onBlur}),r.error&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.error.message})]})})}),e.jsx("div",{children:e.jsx(t,{name:"phone",control:n,render:({field:a,fieldState:r})=>e.jsxs(i,{"data-invalid":r.invalid,children:[e.jsx(s,{htmlFor:"phone",children:"Phone"}),e.jsx(l,{...a,type:"number",id:"phone",name:"phone",placeholder:"Enter phone number"}),r.error&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.error.message})]})})}),e.jsx("div",{children:e.jsx(t,{name:"two_fa_enabled",control:n,render:({field:a,fieldState:r})=>e.jsxs(i,{"data-invalid":r.invalid,children:[e.jsx(s,{htmlFor:"input",children:"Multi-factor authentication"}),e.jsx(A,{checked:a.value,onCheckedChange:a.onChange,label:"Enable multi-factor authentication to secure your account."})]})})}),e.jsx("div",{children:e.jsx(t,{name:"two_fa_type",control:n,render:({field:a,fieldState:r})=>e.jsxs(i,{"data-invalid":r.invalid,children:[e.jsx(s,{htmlFor:"two_fa_type",children:"2FA Type"}),e.jsx(g,{value:String(a.value??""),options:z,placeholder:"Select 2FA Type",onChange:d=>a.onChange(Number(d)),onBlur:a.onBlur,className:"dark:bg-dark-900"}),r.error&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.error.message})]})})}),e.jsx("div",{className:"col-span-full",children:e.jsx(b,{className:"my-4"})}),e.jsx("div",{children:e.jsx(t,{name:"address_line_1",control:n,render:({field:a,fieldState:r})=>e.jsxs(i,{"data-invalid":r.invalid,children:[e.jsx(s,{htmlFor:"address_line_1",children:"Address Line 1"}),e.jsx(l,{...a,type:"text",id:"address_line_1",name:"address_line_1",placeholder:"Enter address line 1"}),r.error&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.error.message})]})})}),e.jsx("div",{children:e.jsx(t,{name:"address_line_2",control:n,render:({field:a,fieldState:r})=>e.jsxs(i,{"data-invalid":r.invalid,children:[e.jsx(s,{htmlFor:"address_line_2",children:"Address Line 2"}),e.jsx(l,{...a,type:"text",id:"address_line_2",name:"address_line_2",placeholder:"Enter address line 2 (optional)"}),r.error&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.error.message})]})})}),e.jsx("div",{children:e.jsx(t,{name:"address_line_3",control:n,render:({field:a,fieldState:r})=>e.jsxs(i,{"data-invalid":r.invalid,children:[e.jsx(s,{htmlFor:"address_line_3",children:"Address Line 3"}),e.jsx(l,{...a,type:"text",id:"address_line_3",name:"address_line_3",placeholder:"Enter address line 3 (optional)"}),r.error&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.error.message})]})})}),e.jsx("div",{children:e.jsx(t,{name:"city",control:n,render:({field:a,fieldState:r})=>e.jsxs(i,{"data-invalid":r.invalid,children:[e.jsx(s,{htmlFor:"city",children:"City"}),e.jsx(l,{...a,type:"text",id:"city",name:"city",placeholder:"Enter city"}),r.error&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.error.message})]})})}),e.jsx("div",{children:e.jsx(t,{name:"county",control:n,render:({field:a,fieldState:r})=>e.jsxs(i,{"data-invalid":r.invalid,children:[e.jsx(s,{htmlFor:"county",children:"County"}),e.jsx(l,{...a,type:"text",id:"county",name:"county",placeholder:"Enter county"}),r.error&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.error.message})]})})}),e.jsx("div",{children:e.jsx(t,{name:"country",control:n,render:({field:a,fieldState:r})=>e.jsxs(i,{"data-invalid":r.invalid,children:[e.jsx(s,{htmlFor:"country",children:"Country"}),e.jsx(l,{...a,type:"text",id:"country",name:"country",placeholder:"Enter country"}),r.error&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.error.message})]})})}),e.jsx("div",{children:e.jsx(t,{name:"postcode",control:n,render:({field:a,fieldState:r})=>e.jsxs(i,{"data-invalid":r.invalid,children:[e.jsx(s,{htmlFor:"postcode",children:"Postcode"}),e.jsx(l,{...a,type:"text",id:"postcode",name:"postcode",placeholder:"Enter postcode"}),r.error&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.error.message})]})})}),e.jsx("div",{className:"col-span-full",children:e.jsx(b,{className:"my-4"})}),e.jsx("div",{children:e.jsx(t,{name:"vat_number",control:n,render:({field:a,fieldState:r})=>e.jsxs(i,{"data-invalid":r.invalid,children:[e.jsx(s,{htmlFor:"vat_number",children:"VAT number"}),e.jsx(l,{...a,type:"text",id:"vat_number",name:"vat_number",placeholder:"Enter VAT number"}),r.error&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.error.message})]})})}),e.jsx("div",{children:e.jsx(t,{name:"invoice_query_email",control:n,render:({field:a,fieldState:r})=>e.jsxs(i,{"data-invalid":r.invalid,children:[e.jsx(s,{htmlFor:"invoice_query_email",children:"Invoice Query Email"}),e.jsx(l,{...a,type:"text",id:"invoice_query_email",name:"invoice_query_email",placeholder:"e.g. john@test.com"}),r.error&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.error.message})]})})}),e.jsx("div",{children:e.jsx(t,{name:"max_payment_days",control:n,render:({field:a,fieldState:r})=>e.jsxs(i,{"data-invalid":r.invalid,children:[e.jsx(s,{htmlFor:"max_payment_days",children:"Max Payment Days"}),e.jsx(l,{...a,type:"number",id:"max_payment_days",name:"max_payment_days",placeholder:"30",value:a.value??"",onChange:d=>a.onChange(d.target.value===""?void 0:Number(d.target.value)),onBlur:a.onBlur}),r.error&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.error.message})]})})}),e.jsx("div",{children:e.jsx(t,{name:"target_payment_days",control:n,render:({field:a,fieldState:r})=>e.jsxs(i,{"data-invalid":r.invalid,children:[e.jsx(s,{htmlFor:"target_payment_days",children:"Target Payment Days"}),e.jsx(l,{...a,type:"number",id:"target_payment_days",name:"target_payment_days",placeholder:"30",value:a.value??"",onChange:d=>a.onChange(d.target.value===""?void 0:Number(d.target.value)),onBlur:a.onBlur}),r.error&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.error.message})]})})}),e.jsx("div",{children:e.jsx(t,{name:"preferred_payment_day",control:n,render:({field:a,fieldState:r})=>e.jsxs(i,{"data-invalid":r.invalid,children:[e.jsx(s,{htmlFor:"preferred_payment_day",children:"Preferred Payment Day"}),e.jsx(l,{...a,type:"text",id:"preferred_payment_day",name:"preferred_payment_day"}),r.error&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.error.message})]})})}),e.jsx("div",{children:e.jsx(t,{name:"priority",control:n,render:({field:a,fieldState:r})=>e.jsxs(i,{"data-invalid":r.invalid,children:[e.jsx(s,{htmlFor:"priority",children:"Priority"}),e.jsx(l,{type:"number",id:"priority",name:"priority",placeholder:"Default: 5, Min: 1, Max: 10",min:1,max:10,value:a.value??"",onChange:d=>a.onChange(d.target.value===""?void 0:Number(d.target.value)),onBlur:a.onBlur}),r.error&&e.jsx("p",{className:"mt-1 text-sm text-error-500",children:r.error.message})]})})})]})})}),!h&&e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx(x,{variant:"danger",onClick:()=>u(-1),children:"Cancel"}),!m&&e.jsx(x,{variant:"outline",onClick:()=>p(),children:"Reset"}),e.jsx(x,{type:"submit",form:"form-supplier",children:m?"Update":"Submit"})]})]})]})}export{$ as default};
